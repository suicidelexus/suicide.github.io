<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Анализ ёмкости аудитории в интернете</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; color: #333; }
        h1 { text-align: center; color: #007bff; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #007bff; color: white; }
        .filters { margin: 20px 0; }
        select { padding: 5px; margin: 5px; }
        .chart-container { position: relative; height: 400px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ёмкость аудитории в интернете</h1>
        <p>Анализ по полу, возрасту и интересам (примерные данные в тыс. активных пользователей в RU/СНГ).</p>
        
        <div class="filters">
            <label>Фильтр по полу: </label>
            <select id="genderFilter">
                <option value="">Все</option>
                <option value="Мужчины">Мужчины</option>
                <option value="Женщины">Женщины</option>
            </select>
            <label>Фильтр по возрасту: </label>
            <select id="ageFilter">
                <option value="">Все</option>
                <option value="18-24">18-24</option>
                <option value="25-34">25-34</option>
                <option value="35+">35+</option>
            </select>
            <button onclick="updateTable()">Применить фильтры</button>
        </div>
        
        <table id="dataTable">
            <thead>
                <tr>
                    <th>Пол</th>
                    <th>Возраст</th>
                    <th>Интересы</th>
                    <th>Ёмкость (тыс. пользователей)</th>
                </tr>
            </thead>
            <tbody>
                <!-- Данные будут вставлены JS -->
            </tbody>
        </table>
        
        <div class="chart-container">
            <canvas id="genderChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="ageChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="interestChart"></canvas>
        </div>
    </div>

    <script>
        // Примерные данные (на основе типичных stats: ~50/50 пол, пики в 25-34, популярные интересы)
        const data = [
            { gender: 'Мужчины', age: '18-24', interest: 'Спорт', capacity: 1200 },
            { gender: 'Женщины', age: '18-24', interest: 'Мода', capacity: 900 },
            { gender: 'Мужчины', age: '25-34', interest: 'Технологии', capacity: 1500 },
            { gender: 'Женщины', age: '25-34', interest: 'Красота', capacity: 1100 },
            { gender: 'Мужчины', age: '35+', interest: 'Авто', capacity: 800 },
            { gender: 'Женщины', age: '35+', interest: 'Путешествия', capacity: 700 },
            { gender: 'Мужчины', age: '18-24', interest: 'Игры', capacity: 1000 },
            { gender: 'Женщины', age: '25-34', interest: 'Еда', capacity: 950 }
        ];

        // Функция для рендера таблицы
        function renderTable(filteredData = data) {
            const tbody = document.querySelector('#dataTable tbody');
            tbody.innerHTML = '';
            filteredData.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.gender}</td>
                    <td>${row.age}</td>
                    <td>${row.interest}</td>
                    <td>${row.capacity}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Фильтрация
        function updateTable() {
            const genderFilter = document.getElementById('genderFilter').value;
            const ageFilter = document.getElementById('ageFilter').value;
            let filtered = data;
            if (genderFilter) filtered = filtered.filter(d => d.gender === genderFilter);
            if (ageFilter) filtered = filtered.filter(d => d.age === ageFilter);
            renderTable(filtered);
            updateCharts(filtered); // Обновляем графики
        }

        // График по полу (pie)
        function renderGenderChart(filteredData) {
            const ctx = document.getElementById('genderChart').getContext('2d');
            if (window.genderChart) window.genderChart.destroy();
            const maleSum = filteredData.filter(d => d.gender === 'Мужчины').reduce((sum, d) => sum + d.capacity, 0);
            const femaleSum = filteredData.filter(d => d.gender === 'Женщины').reduce((sum, d) => sum + d.capacity, 0);
            window.genderChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Мужчины', 'Женщины'],
                    datasets: [{ data: [maleSum, femaleSum], backgroundColor: ['#36A2EB', '#FF6384'] }]
                },
                options: { responsive: true, plugins: { title: { display: true, text: 'Распределение по полу' } } }
            });
        }

        // График по возрасту (bar)
        function renderAgeChart(filteredData) {
            const ctx = document.getElementById('ageChart').getContext('2d');
            if (window.ageChart) window.ageChart.destroy();
            const ageSums = {};
            filteredData.forEach(d => {
                ageSums[d.age] = (ageSums[d.age] || 0) + d.capacity;
            });
            window.ageChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(ageSums),
                    datasets: [{ label: 'Ёмкость', data: Object.values(ageSums), backgroundColor: '#FFCE56' }]
                },
                options: { responsive: true, plugins: { title: { display: true, text: 'Распределение по возрасту' } } }
            });
        }

        // График по интересам (radar)
        function renderInterestChart(filteredData) {
            const ctx = document.getElementById('interestChart').getContext('2d');
            if (window.interestChart) window.interestChart.destroy();
            const interestSums = {};
            filteredData.forEach(d => {
                interestSums[d.interest] = (interestSums[d.interest] || 0) + d.capacity;
            });
            window.interestChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: Object.keys(interestSums),
                    datasets: [{ label: 'Ёмкость', data: Object.values(interestSums), backgroundColor: 'rgba(75,192,192,0.2)', borderColor: 'rgba(75,192,192,1)' }]
                },
                options: { responsive: true, plugins: { title: { display: true, text: 'Распределение по интересам' } } }
            });
        }

        // Обновление всех графиков
        function updateCharts(filteredData) {
            renderGenderChart(filteredData);
            renderAgeChart(filteredData);
            renderInterestChart(filteredData);
        }

        // Инициализация
        renderTable();
        updateCharts(data);

        // События для фильтров (автообновление)
        document.getElementById('genderFilter').addEventListener('change', updateTable);
        document.getElementById('ageFilter').addEventListener('change', updateTable);
    </script>
</body>
</html>
